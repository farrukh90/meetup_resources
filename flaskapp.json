{
    "builders": [{
         "type": "amazon-ebs",
         "region": "{{user `region`}}",
         "source_ami": "{{user `ami`}}",
         "instance_type": "{{user `instance_type`}}",
         "ssh_username": "{{user `ssh_username`}}",
         "ami_name": "flask_app-{{timestamp}}"
       }],
    "provisioners": [
        {
        "type": "file",
            "source": "r1soft.repo",
            "destination": "/tmp/r1soft.repo"
        },
        {
        "type": "shell",
            "inline": [
                "sudo cp /tmp/r1soft.repo /etc/yum.repos.d/",
                "sudo yum update -y",
                "sudo yum install git serverbackup-enterprise-agent -y"
            ]
        },
        {
        "type": "shell",
            "inline": [
                "git clone https://github.com/farrukh90/Flaskex.git",
                "sudo mkdir -p /flaskex/",
                "sudo cp Flaskex/flaskex.service /etc/systemd/system/",
                "sudo cp Flaskex/app.py /flaskex/",
                "systemctl enable flaskex"
            ]
        }
    ]
}